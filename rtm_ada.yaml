# Name of the model. Will be the stem of the input model if undefined.
name: rtm_ada_depth_fusion

# Whether to enable rich formatting for the log messages.
rich_logging: true

# Path to an ONNX or IR model. IR is supported only for RVC2 and RVC3 conversions.
# It can be either a local file or an S3 url. Required.
# TODO
input_model: "models/rtm_ada_WEIGHTLESS.onnx"

# Keep the intermediate files created during the compilation.
keep_intermediate_outputs: true

# Do not run ONNX simplifier on the provided model.
disable_onnx_simplification: false

# Do not run ONNX graph optimizations on the provided model.
disable_onnx_optimization: false

inputs:
  - name: input
    shape: [
      1,
      3,
      384,
      288
    ]
    layout: "NCHW"
    data_type: float16
    scale_values: "imagenet"
    mean_values: "imagenet"
    encoding:
      from: RGB
      to: BGR
    calibration:
      path: "calibration_data/RandomRGBCalibration/"
      resize_method: RESIZE

  - name: depth
    shape: [
      1,
      1,
      384,
      288
    ]
    layout: "NCHW"
    data_type: float16
    scale_values: [ 1.0 ]
    mean_values: [ 0.0 ]
    encoding: GRAY
    calibration:
      path: "calibration_data/RandomDepthCalibration/"
      resize_method: RESIZE

  - name: camera_K_inv
    shape: [
      1,
      2,
      2
    ]
    layout: "NCD"
    data_type: float16
    scale_values: [ 1.0 ]
    mean_values: [ 0.0 ]
    encoding: NONE
    calibration:
      path: "calibration_data/RandomKInvCalibration/"
      resize_method: RESIZE

outputs:
  - name: "kps_xyz"
    shape: [
      1,
      133,
      3
    ]
    layout: "NCW"
    data_type: "float16"

  - name: "dbg_torso_root_center_pred"
    "shape": [
      1,
      1,
      3
    ]
    "layout": "NCH"
    "data_type": "float16"

  - name: "dbg_kp_pix_confidence"
    "shape": [
      1,
      133,
      2
    ]
    "layout": "NCH"
    "data_type": "float16"

  - name: "dbg_kp_z_pred"
    "shape": [
      1,
      19
    ]
    "layout": "ND"
    "data_type": "float16"

  - name: "dbg_px_coords"
    "shape": [
      1,
      133,
      2
    ]
    "layout": "NCD"
    "data_type": "float16"

  - name: "dbg_z_prior"
    "shape": [
      1,
      133,
      1
    ]
    "layout": "NCD"
    "data_type": "float16"




# --- RVC4-Specific Arguments ---
rvc4:
  # List of additional arguments to pass to SNPE onnx-to-dlc.
  # The additional arguments are passed as-is and always take precedence
  # over the default arguments.

  snpe_onnx_to_dlc_args: [
    "--input_type", "input", "image",
    #        "--input_type", "camera_K_inv", "opaque",
  ]

  # List of additional arguments to pass to SNPE snpe-dlc-quant.
  snpe_dlc_quant_args: [
    "--verbose"
  ]

  # List of additional arguments to pass to SNPE snpe-dlc-graph-prepare.
  snpe_dlc_graph_prepare_args: [ ]

  # Disables calibration/quantization.
  disable_calibration: false

  # Whether to include the raw images in the intermediate outputs.
  # Warning: the raw images can get very large.
  keep_raw_images: False

  # Selects per-axis-element quantization for the weights
  # and biases of certain layer types.
  # Only Convolution, Deconvolution, and FullyConnected are supported.
  use_per_channel_quantization: True

  # Enables row wise quantization of Matmul and FullyConnected ops.
  use_per_row_quantization: False

  # List of platforms to pre-compute the DLC graph for.
  htp_socs: [ "sm8550" ]

  # Optimization level for the DLC graph preparation. The available levels are: 1, 2, and 3. Higher optimization levels incur longer offline prepare time but yields more optimal graph and hence faster execution time for most graphs.
  optimization_level: 3

  # Pre-defined quantization modes for the RVC4 exporter. Pre-defined modes (except CUSTOM) will override any user-provided SNPE arguments via `snpe_onnx_to_dlc_args`, `snpe_dlc_quant_args`, and `snpe_dlc_graph_prepare_args`. The available quantization modes are: INT8_STANDARD, INT8_ACCURACY_FOCUSED, INT8_INT16_MIXED, FP16_STANDARD, and CUSTOM.
#  quantization_mode: CUSTOM
  quantization_mode: INT8_STANDARD
